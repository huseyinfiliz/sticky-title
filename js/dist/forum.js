(()=>{var e={n:t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},d:(t,i)=>{for(var o in i)e.o(i,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:i[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};(()=>{"use strict";const t=flarum.core.compat["common/extend"],i=flarum.core.compat["forum/components/PostStreamScrubber"];var o=e.n(i);const r=flarum.core.compat["forum/components/DiscussionPage"];var n=e.n(r);app.initializers.add("huseyinfiliz/sticky-title",function(){if(console.log("[huseyinfiliz/sticky-title] Forum loaded"),window.innerWidth<=767){var e=function(){app.forum&&app.forum.attribute&&!1!==app.forum.attribute("stickyTitleFofPagesHeader")&&app.current&&app.current.get&&"page"===app.current.get("routeName")&&setTimeout(function(){var e=document.querySelector(".PageHero-title, h1.PageHero-title"),t=document.querySelector("#app-navigation .Navigation");if(console.log("[StickyTitle] Page title found:",null==e?void 0:e.textContent),console.log("[StickyTitle] Navigation found:",!!t),e&&t&&!t.querySelector(".PageTitle")){var i=document.createElement("div");i.className="PageTitle Navigation-title",i.textContent=e.textContent.trim();var o=t.querySelector(".Navigation-back");o?(o.parentNode.insertBefore(i,o.nextSibling),console.log("[StickyTitle] Title added to navigation")):t.appendChild(i)}},1)};setTimeout(e,1);var i=history.pushState;if(history.pushState=function(){i.apply(history,arguments),e()},window.addEventListener("popstate",e),m&&m.route){var r=m.route.set;m.route.set=function(){var t=r.apply(m.route,arguments);return setTimeout(e,1),t}}document.addEventListener("DOMContentLoaded",function(){return setTimeout(e,1)}),window.addEventListener("load",function(){return setTimeout(e,1)})}var a=0,l=null;(0,t.extend)(o().prototype,"oninit",function(e){this.showingTitle=!1;var t=this.attrs.stream.discussion;t&&this.lastDiscussionId!==t.id()&&(this.lastDiscussionId=t.id(),this.showingTitle=!1,a=0)}),(0,t.extend)(o().prototype,"view",function(e){window.innerWidth>767||"never"!==app.forum.attribute("stickyTitleMobileScroll")&&this.attrs.stream.discussion&&e&&e.attrs&&(e.attrs.className=(e.attrs.className||"")+(this.showingTitle?" showing-title":""))}),(0,t.extend)(o().prototype,"oncreate",function(e){var t=this;if(window.innerWidth<=767){var i=app.forum.attribute("stickyTitleMobileScroll");if("never"!==i){var o=this.attrs.stream.discussion;if(o){var r=this.element.querySelector(".Dropdown-toggle");if(r&&!r.querySelector(".MobileStickyTitle")){var n=r.innerHTML;r.innerHTML='\n              <span class="MobileOriginalContent">'+n+'</span>\n              <span class="MobileStickyTitle">'+o.title()+"</span>\n            "}l&&window.removeEventListener("scroll",l),l=function(){var e=window.pageYOffset||document.documentElement.scrollTop,o=e>a?"down":"up";a=e<=0?0:e;var r=!1;("always"===i&&e>100||"scroll_down"===i&&"down"===o&&e>100||"scroll_up"===i&&"up"===o&&e>100)&&(r=!0),t.showingTitle!==r&&(t.showingTitle=r,t.element.classList.toggle("showing-title",r))},window.addEventListener("scroll",l),this.scrollHandler=l}}}var s=app.forum.attribute("stickyTitleScrubberReplace"),c=window.innerWidth<=767,u=!1;if("both"===s||"mobile"===s&&c?u=!0:"desktop"!==s||c||(u=!0),u){var d=this.attrs.stream.discussion;if(d){var p=this.element.querySelector(".Scrubber-first");if(p){var m=p.querySelector("i");p.innerHTML="",m&&(p.appendChild(m.cloneNode(!0)),p.appendChild(document.createTextNode(" ")));var f=document.createElement("span");f.className="ScrubberTitle",f.textContent=d.title(),f.title=d.title(),p.appendChild(f)}}}}),(0,t.extend)(o().prototype,"onupdate",function(e){var t=app.forum.attribute("stickyTitleScrubberReplace"),i=window.innerWidth<=767,o=!1;if("both"===t||"mobile"===t&&i?o=!0:"desktop"!==t||i||(o=!0),o){var r=this.attrs.stream.discussion;if(r){var n=this.element.querySelector(".Scrubber-first");if(n&&!n.querySelector(".ScrubberTitle")){var a=n.querySelector("i");n.innerHTML="",a&&(n.appendChild(a.cloneNode(!0)),n.appendChild(document.createTextNode(" ")));var l=document.createElement("span");l.className="ScrubberTitle",l.textContent=r.title(),l.title=r.title(),n.appendChild(l)}}}}),(0,t.extend)(o().prototype,"onremove",function(){this.scrollHandler&&(window.removeEventListener("scroll",this.scrollHandler),this.scrollHandler=null)}),(0,t.extend)(n().prototype,"sidebarItems",function(e){var t=this;if(app.forum.attribute("stickyTitleWebScrubber")&&!(window.innerWidth<=767)){var i=this.discussion;if(i){var o=i.tags(),r=app.forum.attribute("stickyTitleTagColorStyle")||"background";e.add("sticky-title",m(".StickyTitlePanel",[m(".StickyTitlePanel-container",{onclick:function(){var e=t.stream;e&&e.goToNumber(1)},style:"cursor: pointer;"},[m(".StickyTitlePanel-header",[m(".StickyTitlePanel-label",i.title())]),m(".StickyTitlePanel-content",[o&&o.length>0?m(".StickyTitlePanel-tags",{className:"tag-style-"+r},o.map(function(e){var t={},i=["TagLabel"];return e.isChild()&&i.push("TagLabel--child"),"background"===r?(t.backgroundColor=e.color()||"#888",t.color="#fff"):"text"===r?(t.color=e.color()||"#888",t.backgroundColor="transparent",t.border="1px solid currentColor"):"border"===r&&(t.borderColor=e.color()||"#888",t.border="2px solid "+(e.color()||"#888"),t.color=e.color()||"#888",t.backgroundColor="transparent"),m("span.TagLabel",{style:Object.keys(t).map(function(e){return e+": "+t[e]}).join("; "),className:i.join(" ")},[e.icon()?m("span.TagLabel-icon",m("i",{className:e.icon()})):null,m("span.TagLabel-text",e.name())])})):m(".StickyTitlePanel-meta",[m("span.StickyTitlePanel-arrow",m("i.fas.fa-arrow-up")),m("span",app.translator.trans("core.forum.post_scrubber.original_post_link"))])])])]),1)}}})})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map